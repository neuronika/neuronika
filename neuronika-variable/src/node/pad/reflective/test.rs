use super::{PaddingMode, Reflective};

use ndarray::{self, Array, IntoDimension, Ix3, Ix4, Ix5};

#[test]
fn test_1d() {
    let padding = Reflective;

    let base = Array::range(0., 5., 1.);
    let mut padded = Array::<f32, _>::zeros(9);

    PaddingMode::<Ix3>::pad(
        &padding,
        &mut padded.view_mut(),
        &base.view(),
        [2].into_dimension(),
    );

    assert_eq!(padded, ndarray::array![2., 1., 0., 1., 2., 3., 4., 3., 2.]);
}

#[test]
fn test_2d() {
    let padding = Reflective;

    let base = Array::range(0.0, 25.0, 1.0).into_shape((5, 5)).unwrap();
    let mut padded = Array::<f32, _>::zeros((7, 9));

    PaddingMode::<Ix4>::pad(
        &padding,
        &mut padded.view_mut(),
        &base.view(),
        [1, 2].into_dimension(),
    );

    assert_eq!(
        padded,
        ndarray::array![
            [7., 6., 5., 6., 7., 8., 9., 8., 7.],
            [2., 1., 0., 1., 2., 3., 4., 3., 2.],
            [7., 6., 5., 6., 7., 8., 9., 8., 7.],
            [12., 11., 10., 11., 12., 13., 14., 13., 12.],
            [17., 16., 15., 16., 17., 18., 19., 18., 17.],
            [22., 21., 20., 21., 22., 23., 24., 23., 22.],
            [17., 16., 15., 16., 17., 18., 19., 18., 17.]
        ]
    );
}

#[test]
fn test_3d() {
    let padding = Reflective;

    let base = ndarray::Array::range(0., 125., 1.)
        .into_shape((5, 5, 5))
        .unwrap();
    let mut padded = Array::<f32, _>::zeros((7, 9, 11));

    PaddingMode::<Ix5>::pad(
        &padding,
        &mut padded.view_mut(),
        &base.view(),
        [1, 2, 3].into_dimension(),
    );

    assert_eq!(
        padded,
        ndarray::array![
            [
                [38., 37., 36., 35., 36., 37., 38., 39., 38., 37., 36.],
                [33., 32., 31., 30., 31., 32., 33., 34., 33., 32., 31.],
                [28., 27., 26., 25., 26., 27., 28., 29., 28., 27., 26.],
                [33., 32., 31., 30., 31., 32., 33., 34., 33., 32., 31.],
                [38., 37., 36., 35., 36., 37., 38., 39., 38., 37., 36.],
                [43., 42., 41., 40., 41., 42., 43., 44., 43., 42., 41.],
                [48., 47., 46., 45., 46., 47., 48., 49., 48., 47., 46.],
                [43., 42., 41., 40., 41., 42., 43., 44., 43., 42., 41.],
                [38., 37., 36., 35., 36., 37., 38., 39., 38., 37., 36.]
            ],
            [
                [13., 12., 11., 10., 11., 12., 13., 14., 13., 12., 11.],
                [8., 7., 6., 5., 6., 7., 8., 9., 8., 7., 6.],
                [3., 2., 1., 0., 1., 2., 3., 4., 3., 2., 1.],
                [8., 7., 6., 5., 6., 7., 8., 9., 8., 7., 6.],
                [13., 12., 11., 10., 11., 12., 13., 14., 13., 12., 11.],
                [18., 17., 16., 15., 16., 17., 18., 19., 18., 17., 16.],
                [23., 22., 21., 20., 21., 22., 23., 24., 23., 22., 21.],
                [18., 17., 16., 15., 16., 17., 18., 19., 18., 17., 16.],
                [13., 12., 11., 10., 11., 12., 13., 14., 13., 12., 11.]
            ],
            [
                [38., 37., 36., 35., 36., 37., 38., 39., 38., 37., 36.],
                [33., 32., 31., 30., 31., 32., 33., 34., 33., 32., 31.],
                [28., 27., 26., 25., 26., 27., 28., 29., 28., 27., 26.],
                [33., 32., 31., 30., 31., 32., 33., 34., 33., 32., 31.],
                [38., 37., 36., 35., 36., 37., 38., 39., 38., 37., 36.],
                [43., 42., 41., 40., 41., 42., 43., 44., 43., 42., 41.],
                [48., 47., 46., 45., 46., 47., 48., 49., 48., 47., 46.],
                [43., 42., 41., 40., 41., 42., 43., 44., 43., 42., 41.],
                [38., 37., 36., 35., 36., 37., 38., 39., 38., 37., 36.]
            ],
            [
                [63., 62., 61., 60., 61., 62., 63., 64., 63., 62., 61.],
                [58., 57., 56., 55., 56., 57., 58., 59., 58., 57., 56.],
                [53., 52., 51., 50., 51., 52., 53., 54., 53., 52., 51.],
                [58., 57., 56., 55., 56., 57., 58., 59., 58., 57., 56.],
                [63., 62., 61., 60., 61., 62., 63., 64., 63., 62., 61.],
                [68., 67., 66., 65., 66., 67., 68., 69., 68., 67., 66.],
                [73., 72., 71., 70., 71., 72., 73., 74., 73., 72., 71.],
                [68., 67., 66., 65., 66., 67., 68., 69., 68., 67., 66.],
                [63., 62., 61., 60., 61., 62., 63., 64., 63., 62., 61.]
            ],
            [
                [88., 87., 86., 85., 86., 87., 88., 89., 88., 87., 86.],
                [83., 82., 81., 80., 81., 82., 83., 84., 83., 82., 81.],
                [78., 77., 76., 75., 76., 77., 78., 79., 78., 77., 76.],
                [83., 82., 81., 80., 81., 82., 83., 84., 83., 82., 81.],
                [88., 87., 86., 85., 86., 87., 88., 89., 88., 87., 86.],
                [93., 92., 91., 90., 91., 92., 93., 94., 93., 92., 91.],
                [98., 97., 96., 95., 96., 97., 98., 99., 98., 97., 96.],
                [93., 92., 91., 90., 91., 92., 93., 94., 93., 92., 91.],
                [88., 87., 86., 85., 86., 87., 88., 89., 88., 87., 86.]
            ],
            [
                [113., 112., 111., 110., 111., 112., 113., 114., 113., 112., 111.],
                [108., 107., 106., 105., 106., 107., 108., 109., 108., 107., 106.],
                [103., 102., 101., 100., 101., 102., 103., 104., 103., 102., 101.],
                [108., 107., 106., 105., 106., 107., 108., 109., 108., 107., 106.],
                [113., 112., 111., 110., 111., 112., 113., 114., 113., 112., 111.],
                [118., 117., 116., 115., 116., 117., 118., 119., 118., 117., 116.],
                [123., 122., 121., 120., 121., 122., 123., 124., 123., 122., 121.],
                [118., 117., 116., 115., 116., 117., 118., 119., 118., 117., 116.],
                [113., 112., 111., 110., 111., 112., 113., 114., 113., 112., 111.]
            ],
            [
                [88., 87., 86., 85., 86., 87., 88., 89., 88., 87., 86.],
                [83., 82., 81., 80., 81., 82., 83., 84., 83., 82., 81.],
                [78., 77., 76., 75., 76., 77., 78., 79., 78., 77., 76.],
                [83., 82., 81., 80., 81., 82., 83., 84., 83., 82., 81.],
                [88., 87., 86., 85., 86., 87., 88., 89., 88., 87., 86.],
                [93., 92., 91., 90., 91., 92., 93., 94., 93., 92., 91.],
                [98., 97., 96., 95., 96., 97., 98., 99., 98., 97., 96.],
                [93., 92., 91., 90., 91., 92., 93., 94., 93., 92., 91.],
                [88., 87., 86., 85., 86., 87., 88., 89., 88., 87., 86.]
            ]
        ]
    )
}
